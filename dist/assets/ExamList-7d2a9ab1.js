import{r as e,j as s}from"./vendor-react-470eca1f.js";import{H as t}from"./Helmet-2c7e73f6.js";import{N as a}from"./Navbar-fef78110.js";import{S as l}from"./ShareButton-304bb343.js";import{e as r,u as i,s as n,C as c,c as d,a as o,b as m,B as x}from"./index-80385b81.js";import{B as h}from"./badge-3c6eba89.js";import{I as u}from"./input-5c98a0d4.js";import"./tabs-04421a9d.js";import{c as j}from"./vendor-router-da2b77bd.js";import{m as p}from"./vendor-charts-0ffd78b1.js";import{c as b,ap as f,q as g,A as w,z as v,x as N,J as y,g as _,m as S}from"./vendor-ui-297a683c.js";import"./vendor-supabase-1d8f37f5.js";const k=()=>{const{user:k,userProfile:C}=r(),E=j(),{toast:B}=i(),[T,$]=e.useState([]),[M,A]=e.useState([]),[I,L]=e.useState([]),[z,F]=e.useState(!0),[P,R]=e.useState(""),[q,D]=e.useState("all"),[H,O]=e.useState("all"),[J,V]=e.useState("all"),[W,G]=e.useState({total:0,completed:0,averageScore:0,bestScore:0});null==C||C.level,e.useEffect(()=>{k&&(K(),Q())},[k,C]),e.useEffect(()=>{U()},[T,P,q,H,J]);const K=async()=>{try{F(!0);const{data:e,error:s}=await n.from("examens").select("\n          *,\n          matiere:matieres(id, name, level)\n        ").order("created_at",{ascending:!1});if(s)throw s;$(e||[])}catch(e){B({variant:"destructive",title:"Erreur",description:"Impossible de charger les examens"})}finally{F(!1)}},Q=async()=>{try{const{data:e,error:s}=await n.from("exam_results").select("*").eq("user_id",k.id);if(s)throw s;if(L(e||[]),e&&e.length>0){const s=e.length,t=e.reduce((e,s)=>e+(s.score||0),0),a=Math.round(t/s),l=Math.max(...e.map(e=>e.score||0));G({total:T.length,completed:s,averageScore:a,bestScore:l})}}catch(e){}},U=()=>{let e=[...T];P&&(e=e.filter(e=>{var s;return e.title.toLowerCase().includes(P.toLowerCase())||(null==(s=e.description)?void 0:s.toLowerCase().includes(P.toLowerCase()))})),"all"!==q&&(e=e.filter(e=>{var s;return(null==(s=e.matiere)?void 0:s.level)===q})),"all"!==H&&(e=e.filter(e=>e.type===H)),"all"!==J&&(e=e.filter(e=>e.difficulty===J)),A(e)},X=e=>{switch(e){case"facile":return"bg-green-500";case"moyen":return"bg-yellow-500";case"difficile":return"bg-red-500";default:return"bg-gray-500"}},Y=e=>{switch(e){case"blanc":return"Examen Blanc";case"entrainement":return"Entraînement";case"officiel":return"Officiel";default:return e}};return z?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:[s.jsx(a,{}),s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"text-white text-xl",children:"Chargement des examens..."})})]}):s.jsxs(s.Fragment,{children:[s.jsxs(t,{children:[s.jsx("title",{children:"Simulations d'Examens - E-Réussite"}),s.jsx("meta",{name:"description",content:"Préparez-vous avec nos examens blancs et simulations"})]}),s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:[s.jsx(a,{}),s.jsxs("div",{className:"container mx-auto px-4 py-8 pt-24",children:[s.jsxs(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:"Simulations d'Examens"}),s.jsx("p",{className:"text-xl text-blue-200",children:"Préparez-vous efficacement avec nos examens blancs et entraînements"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx(c,{className:"bg-white/10 backdrop-blur-sm border-white/20 dark:border-white/30 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-200 text-sm",children:"Total Examens"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:T.length})]}),s.jsx(b,{className:"w-12 h-12 text-blue-400"})]})})}),s.jsx(c,{className:"bg-white/10 backdrop-blur-sm border-white/20 dark:border-white/30 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-green-200 text-sm",children:"Complétés"}),s.jsx("p",{className:"text-3xl font-bold text-white",children:W.completed})]}),s.jsx(f,{className:"w-12 h-12 text-green-400"})]})})}),s.jsx(c,{className:"bg-white/10 backdrop-blur-sm border-white/20 dark:border-white/30 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-yellow-200 text-sm",children:"Moyenne"}),s.jsxs("p",{className:"text-3xl font-bold text-white",children:[W.averageScore,"%"]})]}),s.jsx(g,{className:"w-12 h-12 text-yellow-400"})]})})}),s.jsx(c,{className:"bg-white/10 backdrop-blur-sm border-white/20 dark:border-white/30 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-purple-200 text-sm",children:"Meilleur Score"}),s.jsxs("p",{className:"text-3xl font-bold text-white",children:[W.bestScore,"%"]})]}),s.jsx(w,{className:"w-12 h-12 text-purple-400"})]})})})]}),s.jsx(c,{className:"bg-white/10 backdrop-blur-sm border-white/20 dark:border-white/30 mb-8 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[s.jsx("div",{className:"md:col-span-2",children:s.jsxs("div",{className:"relative",children:[s.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),s.jsx(u,{type:"text",placeholder:"Rechercher un examen...",value:P,onChange:e=>R(e.target.value),className:"pl-10 bg-white/20 border-white/30 text-white placeholder:text-gray-300"})]})}),s.jsxs("select",{value:q,onChange:e=>D(e.target.value),className:"px-4 py-2 bg-white/20 border border-white/30 rounded-md text-white",children:[s.jsx("option",{value:"all",children:"Tous les niveaux"}),s.jsx("option",{value:"bfem",children:"BFEM"}),s.jsx("option",{value:"bac",children:"BAC"})]}),s.jsxs("select",{value:H,onChange:e=>O(e.target.value),className:"px-4 py-2 bg-white/20 border border-white/30 rounded-md text-white",children:[s.jsx("option",{value:"all",children:"Tous les types"}),s.jsx("option",{value:"blanc",children:"Examen Blanc"}),s.jsx("option",{value:"entrainement",children:"Entraînement"}),s.jsx("option",{value:"officiel",children:"Officiel"})]}),s.jsxs("select",{value:J,onChange:e=>V(e.target.value),className:"px-4 py-2 bg-white/20 border border-white/30 rounded-md text-white",children:[s.jsx("option",{value:"all",children:"Toutes difficultés"}),s.jsx("option",{value:"facile",children:"Facile"}),s.jsx("option",{value:"moyen",children:"Moyen"}),s.jsx("option",{value:"difficile",children:"Difficile"})]})]})})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===M.length?s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx(N,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-300 text-lg",children:"Aucun examen trouvé"})]}):M.map((e,t)=>{var a,r,i;const n=(u=e.id,I.some(e=>e.exam_id===u));var u;const j=(e=>{const s=I.find(s=>s.exam_id===e);return s?s.score:null})(e.id);return s.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:s.jsxs(c,{className:"bg-white/10 backdrop-blur-sm border-white/20 dark:border-white/30 hover:bg-white/20 dark:hover:shadow-[0_0_35px_rgba(255,255,255,0.5)] transition-all h-full flex flex-col shadow-lg dark:shadow-[0_0_25px_rgba(255,255,255,0.3)]",children:[s.jsxs(o,{children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx(h,{className:`${X(e.difficulty)} text-white`,children:e.difficulty}),n&&s.jsxs(h,{className:"bg-green-500 text-white",children:[s.jsx(f,{className:"w-3 h-3 mr-1"}),"Complété"]})]}),s.jsx(m,{className:"text-white text-lg",children:e.title}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-200",children:[s.jsx(b,{className:"w-4 h-4"}),null==(a=e.matiere)?void 0:a.name]})]}),s.jsxs(d,{className:"flex-1 flex flex-col",children:[s.jsx("p",{className:"text-gray-300 text-sm mb-4 flex-1",children:e.description||"Aucune description disponible"}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:[s.jsx(y,{className:"w-4 h-4 mr-2"}),"Durée: ",e.duration_minutes," minutes"]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:[s.jsx(_,{className:"w-4 h-4 mr-2"}),"Type: ",Y(e.type)]}),e.year&&s.jsxs("div",{className:"flex items-center text-sm text-gray-300",children:[s.jsx(S,{className:"w-4 h-4 mr-2"}),"Année: ",e.year]}),n&&null!==j&&s.jsxs("div",{className:"flex items-center text-sm text-green-300 font-semibold",children:[s.jsx(w,{className:"w-4 h-4 mr-2"}),"Score: ",j,"%"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(x,{onClick:()=>(e=>{E(`/exam/${e}`)})(e.id),className:"flex-1 bg-blue-600 hover:bg-blue-700",children:n?"Refaire l'examen":"Commencer l'examen"}),s.jsx(l,{url:`${window.location.origin}/exam/${e.id}`,title:e.title,description:`Examen de ${null==(r=e.matiere)?void 0:r.name} - ${e.duration_minutes} min - ${e.difficulty}`,type:"exam",resourceId:e.id,options:{tags:[null==(i=e.matiere)?void 0:i.name,e.type,e.difficulty]},variant:"outline",showIcon:!0,buttonText:""})]})]})]})},e.id)})})]})]})]})};export{k as default};
