import{_ as e}from"./vendor-supabase-1d8f37f5.js";import{r as s,j as t}from"./vendor-react-470eca1f.js";import{H as a}from"./Helmet-2c7e73f6.js";import{L as r,c as l}from"./vendor-router-da2b77bd.js";import{N as i}from"./Navbar-fef78110.js";import{C as n,a as d,b as c,c as o,B as x,t as m,s as h,d as u,u as g,E as p,e as j,f as b,g as f,h as N}from"./index-80385b81.js";import{P as v}from"./progress-d9418a6f.js";import{T as y,a as w,b as k,c as _}from"./tabs-04421a9d.js";import{ao as S,m as C,g as z,f as D,ap as M,J as $,a as P,aq as A,ar as q,as as E,X as T,D as F,e as R,x as B,at as L,au as O,av as I,aw as V,Z as G,ax as H,c as U,aa as Q,a7 as W,n as J,ay as K,q as Z,az as Y,C as X,A as ee,U as se,p as te,W as ae,aA as re,aB as le,aC as ie,aD as ne,aE as de,d as ce}from"./vendor-ui-297a683c.js";import{R as oe,a as xe,C as me,X as he,Y as ue,T as ge,b as pe,L as je,d as be,A as fe,m as Ne,P as ve,e as ye,f as we,g as ke,B as _e,h as Se}from"./vendor-charts-0ffd78b1.js";import{B as Ce}from"./badge-3c6eba89.js";import{u as ze}from"./useSubscription-4e9a7354.js";import De from"./html2canvas.esm-6d434b9e.js";import{t as Me,a as $e,b as Pe,c as Ae,d as qe,e as Ee}from"./analytics-0f16126e.js";import{f as Te}from"./format-89148104.js";const Fe=({active:e,payload:s,label:a})=>{if(e&&s&&s.length){const e=s[0].payload;return t.jsxs("div",{className:"bg-white border-2 border-primary rounded-lg shadow-lg p-3",children:[t.jsx("p",{className:"font-semibold text-slate-900 mb-2",children:e.dateFormatted}),t.jsxs("p",{className:"text-primary font-bold text-lg mb-1",children:[e.points," points"]}),t.jsxs("p",{className:"text-xs text-slate-500",children:[e.actions," action",e.actions>1?"s":""]}),e.details&&e.details.length>0&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200",children:[t.jsx("p",{className:"text-xs font-semibold text-slate-700 mb-1",children:"D√©tails :"}),e.details.map((e,s)=>t.jsxs("p",{className:"text-xs text-slate-600",children:["‚Ä¢ ","quiz_completion"===e.type?"Quiz":"Le√ßon"," : +",e.points,"pts"]},s))]})]})}return null},Re=({data:e,loading:a=!1})=>{s.useState(7);const[r,l]=s.useState("area");if(a)return t.jsxs(n,{children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(S,{className:"w-5 h-5"}),"√âvolution des Points"]})}),t.jsx(o,{children:t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx("div",{className:"animate-pulse text-slate-400",children:"Chargement des donn√©es..."})})})]});if(!e||0===e.length)return t.jsxs(n,{children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(S,{className:"w-5 h-5"}),"√âvolution des Points"]})}),t.jsx(o,{children:t.jsxs("div",{className:"h-64 flex flex-col items-center justify-center text-slate-400",children:[t.jsx(C,{className:"w-12 h-12 mb-2 opacity-50"}),t.jsx("p",{children:"Pas encore de donn√©es"}),t.jsx("p",{className:"text-sm",children:"Compl√©tez des quiz pour voir votre progression"})]})})]});const i=e.reduce((e,s)=>e+s.points,0),m=Math.round(i/e.length),h=Math.max(...e.map(e=>e.points)),u=e.filter(e=>e.points>0).length;return t.jsxs(n,{children:[t.jsxs(d,{children:[t.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(S,{className:"w-5 h-5 text-primary"}),"√âvolution des Points"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(x,{variant:"line"===r?"default":"outline",size:"sm",onClick:()=>l("line"),children:"Ligne"}),t.jsx(x,{variant:"area"===r?"default":"outline",size:"sm",onClick:()=>l("area"),children:"Zone"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Total"}),t.jsx("p",{className:"text-xl font-bold text-blue-700",children:i})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Moyenne/jour"}),t.jsx("p",{className:"text-xl font-bold text-green-700",children:m})]}),t.jsxs("div",{className:"bg-amber-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-amber-600 font-medium",children:"Record"}),t.jsx("p",{className:"text-xl font-bold text-amber-700",children:h})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[t.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Jours actifs"}),t.jsxs("p",{className:"text-xl font-bold text-purple-700",children:[u,"/",e.length]})]})]})]}),t.jsxs(o,{children:[t.jsx(oe,{width:"100%",height:300,children:"area"===r?t.jsxs(xe,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorPoints",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.8}),t.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})}),t.jsx(me,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),t.jsx(he,{dataKey:"dateFormatted",stroke:"#64748b",style:{fontSize:"12px"}}),t.jsx(ue,{stroke:"#64748b",style:{fontSize:"12px"}}),t.jsx(ge,{content:t.jsx(Fe,{})}),t.jsx(pe,{type:"monotone",dataKey:"points",stroke:"#3b82f6",strokeWidth:2,fill:"url(#colorPoints)",animationDuration:1e3})]}):t.jsxs(je,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[t.jsx(me,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),t.jsx(he,{dataKey:"dateFormatted",stroke:"#64748b",style:{fontSize:"12px"}}),t.jsx(ue,{stroke:"#64748b",style:{fontSize:"12px"}}),t.jsx(ge,{content:t.jsx(Fe,{})}),t.jsx(be,{type:"monotone",dataKey:"points",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",r:4},activeDot:{r:6},animationDuration:1e3})]})}),t.jsxs("div",{className:"mt-4 text-center text-xs text-slate-500",children:["Derniers ",e.length," jours"]})]})]})},Be=({challenges:e,onClaimReward:a,loading:r=!1})=>{const[l,i]=s.useState(null),m=e.filter(e=>"daily"===e.type)||[],h=e.filter(e=>"weekly"===e.type)||[],u=e=>{const s={easy:"bg-green-100 text-green-800 border-green-300",medium:"bg-yellow-100 text-yellow-800 border-yellow-300",hard:"bg-red-100 text-red-800 border-red-300"};return s[e]||s.easy},g=e=>{const s=new Date,t=new Date(e)-s;if(t<0)return"Expir√©";const a=Math.floor(t/36e5),r=Math.floor(t%36e5/6e4);if(a>24){const e=Math.floor(a/24);return`${e}j restant${e>1?"s":""}`}return a>0?`${a}h ${r}m`:`${r}m`},p=({challenge:e})=>{const s="completed"===e.status,r="claimed"===e.status||e.rewards_claimed,n=e.progress_percentage||0;return t.jsxs("div",{className:`\n          relative p-4 rounded-lg border-2 transition-all duration-300\n          ${s||r?"bg-green-50 border-green-300 shadow-sm":"bg-white border-slate-200 hover:border-primary hover:shadow-md"}\n        `,children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"text-3xl p-2 rounded-lg",style:{backgroundColor:e.color+"20"},children:e.icon}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-semibold text-slate-900 text-sm mb-1",children:e.title}),t.jsx("p",{className:"text-xs text-slate-600 line-clamp-2",children:e.description})]})]}),s&&t.jsx(M,{className:"w-5 h-5 text-green-600 flex-shrink-0"})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(Ce,{variant:"outline",className:`text-xs ${u(e.difficulty)}`,children:(d=e.difficulty,{easy:"Facile",medium:"Moyen",hard:"Difficile"}[d]||d)}),t.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[t.jsx($,{className:"w-3 h-3"}),t.jsx("span",{children:g(e.expires_at)})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[t.jsx("span",{className:"text-slate-600",children:"Progression"}),t.jsxs("span",{className:"font-semibold text-slate-900",children:[e.progress," / ",e.target]})]}),t.jsx(v,{value:n,className:"h-2",style:{"--progress-background":e.color}}),t.jsxs("div",{className:"text-right text-xs text-slate-500 mt-1",children:[n,"%"]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-slate-100",children:[t.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.reward_points>0&&t.jsxs("div",{className:"flex items-center gap-1 text-amber-600",children:[t.jsx(P,{className:"w-4 h-4"}),t.jsxs("span",{className:"font-semibold",children:["+",e.reward_points]})]}),e.reward_badge&&t.jsxs("div",{className:"flex items-center gap-1 text-purple-600",children:[t.jsx(D,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs",children:"Badge"})]})]}),s&&!r&&t.jsx(x,{size:"sm",onClick:()=>(async e=>{i(e);try{await a(e)}finally{i(null)}})(e.id),disabled:l===e.id,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700",children:l===e.id?t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"R√©clamation..."]}):t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(A,{className:"w-4 h-4"}),"R√©clamer"]})})]})]});var d};return r?t.jsxs(n,{children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(z,{className:"w-5 h-5"}),"D√©fis"]})}),t.jsx(o,{children:t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"}),t.jsx("p",{className:"text-sm text-slate-500",children:"Chargement des d√©fis..."})]})})})]}):0===e.length?t.jsxs(n,{children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(z,{className:"w-5 h-5"}),"D√©fis"]})}),t.jsx(o,{children:t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[t.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:t.jsx(z,{className:"w-8 h-8 text-slate-400"})}),t.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Aucun d√©fi disponible"}),t.jsx("p",{className:"text-sm text-slate-600 text-center max-w-md mb-4",children:"Les d√©fis quotidiens et hebdomadaires appara√Ætront ici. Revenez plus tard pour de nouveaux d√©fis !"}),t.jsxs(x,{variant:"outline",onClick:()=>window.location.reload(),className:"mt-2",children:[t.jsx(S,{className:"w-4 h-4 mr-2"}),"Actualiser"]})]})})]}):t.jsxs(n,{children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(z,{className:"w-5 h-5"}),"D√©fis"]}),t.jsxs(Ce,{variant:"outline",className:"text-xs",children:[e.filter(e=>"completed"===e.status).length," / ",e.length," compl√©t√©s"]})]})}),t.jsxs(o,{className:"space-y-6",children:[m.length>0&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(C,{className:"w-4 h-4 text-blue-600"}),t.jsx("h3",{className:"font-semibold text-sm text-slate-900",children:"D√©fis Quotidiens"}),t.jsxs(Ce,{variant:"secondary",className:"text-xs",children:[m.filter(e=>"completed"===e.status).length," / ",m.length]})]}),t.jsx("div",{className:"grid gap-3",children:m.map(e=>t.jsx(p,{challenge:e},e.id))})]}),h.length>0&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(D,{className:"w-4 h-4 text-purple-600"}),t.jsx("h3",{className:"font-semibold text-sm text-slate-900",children:"D√©fis Hebdomadaires"}),t.jsxs(Ce,{variant:"secondary",className:"text-xs",children:[h.filter(e=>"completed"===e.status).length," / ",h.length]})]}),t.jsx("div",{className:"grid gap-3",children:h.map(e=>t.jsx(p,{challenge:e},e.id))})]})]})]})};function Le({userId:e}){const[a,r]=s.useState(Notification.permission),[l,i]=s.useState(!1),[d,c]=s.useState(!1),[o,u]=s.useState(null),g="Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window&&"BHAW802yH22pv5z0PMG54b4O-3f4AjP2x469HDfj5xvFvch6ZItTS5yzQbyLn4jMP13GP0A15jRCMMDjA3GaaxE";s.useEffect(()=>{g&&p()},[e]);const p=async()=>{try{const e=await navigator.serviceWorker.ready;u(e);const s=await e.pushManager.getSubscription();i(!!s)}catch(e){}},j=async()=>{if(o)try{await o.showNotification("üéâ E-r√©ussite",{body:"Les notifications sont maintenant activ√©es ! Vous serez alert√© des nouveaux d√©fis et badges.",icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"welcome",requireInteraction:!1,vibrate:[200,100,200]})}catch(e){}};function b(e){const s=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(s),a=new Uint8Array(t.length);for(let r=0;r<t.length;++r)a[r]=t.charCodeAt(r);return a}function f(){const e=navigator.userAgent;return/mobile/i.test(e)?"Mobile":/tablet/i.test(e)?"Tablet":"Desktop"}return g?"denied"===a?t.jsx(n,{className:"p-4 bg-red-50 border-red-200",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(q,{className:"w-5 h-5 text-red-600 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-semibold text-red-900 mb-1",children:"Notifications bloqu√©es"}),t.jsx("p",{className:"text-sm text-red-700",children:"Vous avez refus√© les notifications. Pour les activer, modifiez les param√®tres de votre navigateur."})]})]})}):t.jsxs(n,{className:"p-4",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"p-2 rounded-full bg-blue-100",children:l?t.jsx(E,{className:"w-5 h-5 text-blue-600"}):t.jsx(q,{className:"w-5 h-5 text-gray-600"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:l?"Notifications activ√©es":"Activer les notifications"}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:l?"Vous recevez les alertes pour les nouveaux d√©fis, badges et rappels.":"Recevez des notifications pour les nouveaux d√©fis quotidiens, badges d√©bloqu√©s et rappels avant expiration."}),l?t.jsxs("div",{className:"flex gap-2",children:[t.jsx(x,{size:"sm",variant:"outline",onClick:j,disabled:d,children:"Tester"}),t.jsxs(x,{size:"sm",variant:"outline",onClick:async()=>{c(!0);try{const e=await(null==o?void 0:o.pushManager.getSubscription());if(e){await e.unsubscribe();const s=e.toJSON();await h.from("push_subscriptions").update({is_active:!1,notifications_enabled:!1}).eq("endpoint",s.endpoint),i(!1),m.success("Notifications d√©sactiv√©es")}}catch(e){m.error("Erreur lors de la d√©sactivation")}finally{c(!1)}},disabled:d,className:"text-red-600 hover:text-red-700",children:[t.jsx(T,{className:"w-4 h-4 mr-1"}),"D√©sactiver"]})]}):t.jsxs(x,{size:"sm",onClick:async()=>{if(g){c(!0);try{const s=await Notification.requestPermission();if(r(s),"granted"!==s)return m.error("Permission refus√©e. Activez les notifications dans les param√®tres du navigateur."),void c(!1);const t=await navigator.serviceWorker.ready;u(t);const a="BHAW802yH22pv5z0PMG54b4O-3f4AjP2x469HDfj5xvFvch6ZItTS5yzQbyLn4jMP13GP0A15jRCMMDjA3GaaxE",l=(await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:b(a)})).toJSON(),{data:n,error:d}=await h.from("push_subscriptions").upsert({user_id:e,endpoint:l.endpoint,p256dh_key:l.keys.p256dh,auth_key:l.keys.auth,user_agent:navigator.userAgent,device_name:f(),is_active:!0,notifications_enabled:!0,last_used_at:(new Date).toISOString()},{onConflict:"endpoint"}).select();if(d)throw d;i(!0),m.success("üîî Notifications activ√©es ! Vous recevrez les alertes importantes."),await j()}catch(s){m.error(`Erreur: ${s.message||"Impossible d'activer les notifications"}`)}finally{c(!1)}}else m.error("Les notifications ne sont pas support√©es par votre navigateur")},disabled:d,className:"bg-blue-600 hover:bg-blue-700",children:[t.jsx(F,{className:"w-4 h-4 mr-1"}),d?"Activation...":"Activer les notifications"]})]})]}),l&&t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:t.jsx("p",{className:"text-xs text-gray-500",children:"üí° Les notifications fonctionnent m√™me quand l'application est ferm√©e"})})]}):null}function Oe({userId:e,onClose:a}){const[r,l]=s.useState(!1),[i,d]=s.useState(!1);s.useEffect(()=>{c()},[e]);const c=async()=>{if(e)try{if("granted"===Notification.permission)return;const{data:s}=await h.from("profiles").select("login_count, notification_dismiss_count").eq("id",e).single();if(!s)return;const t=s.login_count||0,a=s.notification_dismiss_count||0;t>=2&&a<3&&l(!0)}catch(s){}},o=async()=>{await u(),l(!1),null==a||a()},u=async()=>{try{const{data:s}=await h.from("profiles").select("notification_dismiss_count").eq("id",e).single(),t=(null==s?void 0:s.notification_dismiss_count)||0;await h.from("profiles").update({notification_dismiss_count:t+1}).eq("id",e)}catch(s){}},g=e=>{const s=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(s),a=new Uint8Array(t.length);for(let r=0;r<t.length;++r)a[r]=t.charCodeAt(r);return a};return r?t.jsx(fe,{children:t.jsx(Ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:o,children:t.jsx(Ne.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},onClick:e=>e.stopPropagation(),className:"relative",children:t.jsxs(n,{className:"w-full max-w-lg p-6 shadow-2xl border-2 border-primary/20",children:[t.jsx("button",{onClick:o,className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600 transition-colors",children:t.jsx(T,{className:"w-5 h-5"})}),t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center",children:t.jsx(E,{className:"w-8 h-8 text-white"})})}),t.jsx("h2",{className:"text-2xl font-bold text-center mb-2 text-slate-900 dark:text-white",children:"Ne ratez plus rien ! üîî"}),t.jsx("p",{className:"text-center text-slate-600 dark:text-slate-300 mb-6",children:"Activez les notifications pour maintenir votre s√©rie et ne pas manquer les conseils de l'IA."}),t.jsxs("div",{className:"space-y-3 mb-6",children:[t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:[t.jsx(R,{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-orange-900 dark:text-orange-100 text-sm",children:"Maintenez votre s√©rie üî•"}),t.jsx("p",{className:"text-xs text-orange-700 dark:text-orange-300",children:"Rappel quotidien si vous n'avez pas encore √©tudi√© (envoy√© √† 21h)"})]})]}),t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsx(P,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-blue-900 dark:text-blue-100 text-sm",children:"Conseils de l'IA ü§ñ"}),t.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Recevez des recommandations personnalis√©es bas√©es sur vos performances"})]})]}),t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[t.jsx(D,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-green-900 dark:text-green-100 text-sm",children:"C√©l√©brez vos succ√®s üéâ"}),t.jsx("p",{className:"text-xs text-green-700 dark:text-green-300",children:"Soyez notifi√© quand vous d√©bloquez un badge ou atteignez un nouveau niveau"})]})]})]}),t.jsxs("p",{className:"text-xs text-center text-slate-500 dark:text-slate-400 mb-6",children:[t.jsx($,{className:"w-3 h-3 inline mr-1"}),"Vous pouvez d√©sactiver les notifications √† tout moment dans les param√®tres"]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(x,{variant:"outline",onClick:o,className:"flex-1",disabled:i,children:"Plus tard"}),t.jsx(x,{onClick:async()=>{d(!0);try{if("granted"!==await Notification.requestPermission())return m.error("Permission refus√©e. Vous pouvez l'activer plus tard dans les param√®tres."),await u(),l(!1),void(null==a||a());const s=await navigator.serviceWorker.ready,t="BHAW802yH22pv5z0PMG54b4O-3f4AjP2x469HDfj5xvFvch6ZItTS5yzQbyLn4jMP13GP0A15jRCMMDjA3GaaxE",r=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:g(t)});await h.from("push_subscriptions").insert({user_id:e,endpoint:r.endpoint,p256dh_key:btoa(String.fromCharCode(...new Uint8Array(r.getKey("p256dh")))),auth_key:btoa(String.fromCharCode(...new Uint8Array(r.getKey("auth")))),subscription_data:r.toJSON()}),m.success("üîî Notifications activ√©es ! Vous recevrez des rappels pour maintenir votre s√©rie."),l(!1),null==a||a()}catch(s){m.error("Erreur lors de l'activation. R√©essayez plus tard.")}finally{d(!1)}},className:"flex-1 bg-gradient-to-r from-primary to-blue-600",disabled:i,children:i?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Activation..."]}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E,{className:"w-4 h-4"}),"Activer"]})})]}),t.jsx("p",{className:"text-xs text-center text-slate-400 dark:text-slate-500 mt-3",children:"Ce message ne s'affichera plus apr√®s 3 refus"})]})})})}):null}const Ie=()=>{const{subscription:e,loading:s,status:a,daysRemaining:l,isActive:i}=ze();if(s)return null;if("active"===a)return null;if(!(null==e?void 0:e.has_subscription))return null;const d="expired"===a?{color:"red",bgGradient:"from-red-500 to-rose-600",bgLight:"from-red-50 to-rose-50",borderColor:"border-red-300",textColor:"text-red-700",icon:B,message:"Essai gratuit expir√©",cta:"Payer maintenant pour continuer"}:l<=1?{color:"orange",bgGradient:"from-orange-500 to-amber-600",bgLight:"from-orange-50 to-amber-50",borderColor:"border-orange-300",textColor:"text-orange-700",icon:$,message:"Dernier jour d'essai !",cta:"Continuer avec 1000 FCFA"}:l<=3?{color:"yellow",bgGradient:"from-yellow-500 to-orange-500",bgLight:"from-yellow-50 to-orange-50",borderColor:"border-yellow-300",textColor:"text-yellow-700",icon:$,message:`${l} jours d'essai restants`,cta:"Payer maintenant (1000 FCFA)"}:{color:"blue",bgGradient:"from-blue-500 to-cyan-600",bgLight:"from-blue-50 to-cyan-50",borderColor:"border-blue-300",textColor:"text-blue-700",icon:P,message:`${l} jours d'essai restants`,cta:"Profitez de votre essai !"},c=d.icon;return t.jsx(Ne.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full",children:t.jsx(n,{className:`border-2 ${d.borderColor} shadow-lg overflow-hidden bg-gradient-to-br ${d.bgLight} dark:from-slate-800 dark:to-slate-900`,children:t.jsxs(o,{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[t.jsx(Ne.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0,repeatDelay:3},className:`flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br ${d.bgGradient} flex items-center justify-center shadow-lg`,children:t.jsx(c,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:`text-lg font-bold ${d.textColor} dark:text-white`,children:d.message}),"trial"===a&&t.jsx("span",{className:"px-2 py-1 text-xs font-semibold bg-white/50 dark:bg-slate-700 rounded-full",children:"Essai gratuit"})]}),"trial"===a&&t.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-4",children:["Votre acc√®s gratuit expire le"," ",t.jsx("span",{className:"font-semibold",children:new Date(e.trial_end_date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}),". Ne manquez pas cette opportunit√© !"]}),"expired"===a&&t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-4",children:"Votre essai gratuit a expir√©. Payez 1000 FCFA une seule fois pour continuer √† profiter de tous les cours et du Coach IA √† vie !"}),"trial"===a&&l>=0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:t.jsx(Ne.div,{initial:{width:0},animate:{width:l/7*100+"%"},transition:{duration:1},className:`h-2 rounded-full bg-gradient-to-r ${d.bgGradient}`})}),t.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:[l," jour",l>1?"s":""," sur 7"]})]})]})]}),("expired"===a||l<=3)&&t.jsx(r,{to:"/pricing",children:t.jsx(x,{size:"sm",className:`bg-gradient-to-r ${d.bgGradient} hover:opacity-90 text-white font-semibold shadow-lg hover:scale-105 transition-transform`,children:"expired"===a?"Activer maintenant":"Payer 1000 FCFA"})})]}),"trial"===a&&l<=3&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:[t.jsx("p",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Avec 1000 FCFA unique, vous obtenez :"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-400",children:[t.jsx(F,{className:"w-3 h-3 text-green-600"}),t.jsx("span",{children:"Acc√®s √† vie"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-400",children:[t.jsx(F,{className:"w-3 h-3 text-green-600"}),t.jsx("span",{children:"Coach IA 24h/24"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-400",children:[t.jsx(F,{className:"w-3 h-3 text-green-600"}),t.jsx("span",{children:"Tous les cours"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-400",children:[t.jsx(F,{className:"w-3 h-3 text-green-600"}),t.jsx("span",{children:"Quiz illimit√©s"})]})]})]})]})})})},Ve=O,Ge=I,He=V,Ue=s.forwardRef(({className:e,sideOffset:s=4,...a},r)=>t.jsx(L,{ref:r,sideOffset:s,className:u("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a}));function Qe({currentStreak:e=0,longestStreak:s=0,compact:a=!1}){const r=[3,7,30,90,365],l=r.find(s=>s>e)||365,i=r.filter(s=>s<=e).pop()||0,n=0===i?e/l*100:(e-i)/(l-i)*100,d=()=>e>=30?"text-red-600":e>=7?"text-orange-600":e>=3?"text-orange-500":"text-orange-400",c=e>=30?D:e>=7?G:R;return a?t.jsx(Ve,{children:t.jsxs(Ge,{children:[t.jsx(He,{asChild:!0,children:t.jsxs(Ne.div,{className:"flex items-center gap-2 px-3 py-1.5 bg-orange-50 dark:bg-orange-900/20 rounded-full cursor-pointer hover:bg-orange-100 dark:hover:bg-orange-900/30 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[t.jsx(Ne.div,{animate:{scale:[1,1.2,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,repeatDelay:1},children:t.jsx(c,{className:`w-4 h-4 ${d()}`})}),t.jsx("span",{className:`text-sm font-bold ${d()}`,children:e})]})}),t.jsx(Ue,{children:t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"font-semibold",children:[e," jours cons√©cutifs"]}),t.jsxs("p",{className:"text-xs text-slate-500",children:["Record: ",s," jours"]}),t.jsxs("p",{className:"text-xs text-slate-500",children:["Prochain: ",l," jours"]})]})})]})}):t.jsxs(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 rounded-xl p-6 shadow-sm hover:shadow-lg transition-all border border-orange-200 dark:border-orange-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"S√©rie actuelle"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ne.div,{animate:{scale:[1,1.15,1],rotate:[0,8,-8,0]},transition:{duration:2.5,repeat:1/0,repeatDelay:1.5},children:t.jsx(c,{className:`w-8 h-8 ${d()}`})}),t.jsx("span",{className:`text-4xl font-bold ${d()}`,children:e}),t.jsx("span",{className:"text-lg text-slate-500 dark:text-slate-400",children:"jours"})]})]}),s>0&&t.jsx(Ve,{children:t.jsxs(Ge,{children:[t.jsx(He,{asChild:!0,children:t.jsx(Ne.div,{whileHover:{scale:1.1},className:"bg-white dark:bg-slate-800 rounded-full p-3 shadow-md cursor-pointer",children:t.jsx(D,{className:"w-6 h-6 text-yellow-600"})})}),t.jsxs(Ue,{children:[t.jsx("p",{className:"font-semibold",children:"Record personnel"}),t.jsxs("p",{className:"text-sm",children:[s," jours"]})]})]})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600 dark:text-slate-400",children:[t.jsxs("span",{children:["Prochain objectif: ",l," jours"]}),t.jsxs("span",{className:"font-semibold",children:[Math.round(n),"%"]})]}),t.jsx(v,{value:n,className:"h-2 bg-orange-100 dark:bg-orange-900/30",indicatorClassName:"bg-gradient-to-r from-orange-500 to-red-500"}),t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-slate-500 dark:text-slate-500",children:i>0?`${i} jours`:"D√©but"}),t.jsxs(Ne.span,{animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},className:"text-orange-600 dark:text-orange-400 font-medium",children:[l-e," jours restants"]})]})]}),[3,7,30,90,365].includes(e)&&t.jsxs(Ne.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200,damping:15,delay:.3},className:"mt-4 bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700 rounded-lg p-3 text-center",children:[t.jsxs("p",{className:"text-sm font-bold text-yellow-800 dark:text-yellow-300",children:["üéâ Objectif atteint : ",e," jours !"]}),t.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400 mt-1",children:"Continue comme √ßa, tu es incroyable ! üî•"})]})]})}Ue.displayName=L.displayName;const We=({title:e,value:s,icon:a,color:r="blue",change:l,changeType:i="increase",subtitle:d,className:c=""})=>{const x={blue:{bg:"bg-blue-500/10 dark:bg-blue-500/20",text:"text-blue-600 dark:text-blue-400",icon:"text-blue-500",border:"border-blue-200 dark:border-blue-800"},green:{bg:"bg-green-500/10 dark:bg-green-500/20",text:"text-green-600 dark:text-green-400",icon:"text-green-500",border:"border-green-200 dark:border-green-800"},purple:{bg:"bg-purple-500/10 dark:bg-purple-500/20",text:"text-purple-600 dark:text-purple-400",icon:"text-purple-500",border:"border-purple-200 dark:border-purple-800"},orange:{bg:"bg-orange-500/10 dark:bg-orange-500/20",text:"text-orange-600 dark:text-orange-400",icon:"text-orange-500",border:"border-orange-200 dark:border-orange-800"},red:{bg:"bg-red-500/10 dark:bg-red-500/20",text:"text-red-600 dark:text-red-400",icon:"text-red-500",border:"border-red-200 dark:border-red-800"}},m=x[r]||x.blue;return t.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:[.4,0,.2,1]},className:c,children:t.jsxs(n,{className:`relative overflow-hidden border-2 ${m.border} hover:shadow-lg hover:scale-105 transition-all duration-300`,children:[t.jsx("div",{className:`absolute inset-0 ${m.bg} opacity-50`}),t.jsxs(o,{className:"p-6 relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:`p-3 rounded-xl ${m.bg} border ${m.border}`,children:t.jsx(a,{className:`h-6 w-6 ${m.icon}`})}),l&&t.jsxs("div",{className:"flex items-center gap-1 text-sm font-medium "+("increase"===i?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:["increase"===i?t.jsx(S,{className:"h-4 w-4"}):t.jsx(H,{className:"h-4 w-4"}),t.jsx("span",{className:"text-xs",children:l})]})]}),t.jsx("div",{className:`text-3xl font-bold ${m.text} mb-2`,children:s}),t.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:e}),d&&t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:d})]})]})})},Je=({data:e=[],title:s="R√©partition par mati√®re",subtitle:a="",className:r=""})=>{const l=["#3B82F6","#10B981","#A855F7","#F97316","#EC4899","#8B5CF6","#059669","#F59E0B"];if(!e||0===e.length)return t.jsxs(n,{className:`${r}`,children:[t.jsxs(d,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(U,{className:"h-5 w-5 text-primary"}),s]}),a&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a})]}),t.jsx(o,{children:t.jsx("div",{className:"h-[300px] flex items-center justify-center",children:t.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[t.jsx(U,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"font-medium",children:"Aucune donn√©e disponible"}),t.jsx("p",{className:"text-sm",children:"Commencez √† √©tudier pour voir vos statistiques"})]})})})]});const i=e.reduce((e,s)=>e+s.value,0),x=({active:e,payload:s})=>{if(e&&s&&s.length){const e=s[0],a=(e.value/i*100).toFixed(2),r=(i/s.length).toFixed(1),l=((e.value-r)/r*100).toFixed(1),n=e.value>=r;return t.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 p-4 rounded-xl shadow-2xl border-2 border-gray-200 dark:border-gray-700 backdrop-blur-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.payload.color||e.color}}),t.jsx("p",{className:"font-bold text-gray-900 dark:text-white",children:e.name})]}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:["‚è±Ô∏è ",e.value,"h (",a,"%)"]}),t.jsxs("p",{className:"text-xs flex items-center gap-1 "+(n?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400"),children:[n?"‚Üë":"‚Üì"," ",Math.abs(l),"% vs moyenne (",r,"h)"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:n?"‚ú® Mati√®re prioritaire":"üí° √Ä renforcer"})]})]})}return null};return t.jsxs(n,{className:`${r}`,children:[t.jsxs(d,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(U,{className:"h-5 w-5 text-primary"}),s]}),a&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a})]}),t.jsxs(o,{children:[t.jsx(oe,{width:"100%",height:300,children:t.jsxs(ve,{children:[t.jsx(ye,{data:e,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",label:e=>`${(e.value/i*100).toFixed(1)}%`,labelLine:!1,children:e.map((e,s)=>t.jsx(we,{fill:e.color||l[s%l.length]},`cell-${s}`))}),t.jsx(ge,{content:t.jsx(x,{})}),t.jsx(ke,{verticalAlign:"bottom",height:36,formatter:(e,s)=>t.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e," (",s.payload.value,"h)"]})})]})}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Temps total"}),t.jsxs("span",{className:"text-lg font-bold text-primary",children:[i,"h"]})]})})]})]})},Ke=({data:e=[],title:s="Temps d'√©tude quotidien",subtitle:a="",className:r=""})=>{if(!e||0===e.length)return t.jsxs(n,{className:`${r}`,children:[t.jsxs(d,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx($,{className:"h-5 w-5 text-primary"}),s]}),a&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a})]}),t.jsx(o,{children:t.jsx("div",{className:"h-[300px] flex items-center justify-center",children:t.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[t.jsx($,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"font-medium",children:"Aucune donn√©e disponible"}),t.jsx("p",{className:"text-sm",children:"Commencez √† √©tudier pour voir vos statistiques"})]})})})]});const l=e.reduce((e,s)=>e+(s.minutes||0),0),i=Math.round(l/e.length),x=({active:e,payload:s,label:a})=>{if(e&&s&&s.length){const e=s[0],a=Math.floor(e.value/60),r=e.value%60,l=((e.value-i)/i*100).toFixed(1),n=e.value>=i,d={Lun:"Lundi",Mar:"Mardi",Mer:"Mercredi",Jeu:"Jeudi",Ven:"Vendredi",Sam:"Samedi",Dim:"Dimanche"}[e.payload.day]||e.payload.day;return t.jsxs("div",{className:"bg-gradient-to-br from-white to-blue-50 dark:from-gray-800 dark:to-blue-950 p-4 rounded-xl shadow-2xl border-2 border-blue-200 dark:border-blue-700 backdrop-blur-sm min-w-[200px]",children:[t.jsx("div",{className:"mb-2",children:t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:d})}),t.jsx("div",{className:"mb-3",children:t.jsxs("p",{className:"text-2xl font-bold text-primary",children:[a>0&&`${a}h `,r>0&&`${r}min`,0===a&&0===r&&"0min"]})}),t.jsxs("div",{className:"space-y-2 text-xs",children:[t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg "+(n?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"),children:[t.jsxs("span",{children:[n?"‚Üë":"‚Üì"," ",Math.abs(l),"%"]}),t.jsx("span",{className:"font-semibold",children:"vs moyenne"})]}),t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-center",children:["üìä Moyenne: ",Math.floor(i/60),"h ",i%60,"min"]}),t.jsx("p",{className:"text-center font-medium pt-2 border-t border-gray-200 dark:border-gray-700",children:n?"üî• Excellent !":"üí™ Continue !"})]})]})}return null};return t.jsxs(n,{className:`${r}`,children:[t.jsxs(d,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx($,{className:"h-5 w-5 text-primary"}),s]}),a&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a})]}),t.jsxs(o,{children:[t.jsx(oe,{width:"100%",height:300,children:t.jsxs(_e,{data:e,children:[t.jsx(me,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),t.jsx(he,{dataKey:"day",stroke:"#6b7280",tick:{fill:"#6b7280"},className:"dark:stroke-gray-400"}),t.jsx(ue,{stroke:"#6b7280",tick:{fill:"#6b7280"},className:"dark:stroke-gray-400",label:{value:"Minutes",angle:-90,position:"insideLeft",style:{fill:"#6b7280"}}}),t.jsx(ge,{content:t.jsx(x,{})}),t.jsx(Se,{dataKey:"minutes",fill:"#10B981",radius:[8,8,0,0],animationDuration:800})]})}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total"}),t.jsxs("p",{className:"text-lg font-bold text-primary",children:[Math.floor(l/60),"h",l%60,"min"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Moyenne/jour"}),t.jsxs("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[Math.floor(i/60),"h",i%60,"min"]})]})]})]})]})},Ze=({data:e=[],title:s="√âvolution du streak",subtitle:a="",className:r=""})=>{if(!e||0===e.length)return t.jsxs(n,{className:`${r}`,children:[t.jsxs(d,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(R,{className:"h-5 w-5 text-orange-500"}),s]}),a&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a})]}),t.jsx(o,{children:t.jsx("div",{className:"h-[300px] flex items-center justify-center",children:t.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[t.jsx(R,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"font-medium",children:"Aucune donn√©e disponible"}),t.jsx("p",{className:"text-sm",children:"Commencez √† √©tudier pour construire votre streak"})]})})})]});const l=e.map(e=>e.streak||0),i=Math.max(...l),x=l[l.length-1]||0,m=Math.round(l.reduce((e,s)=>e+s,0)/l.length),h=({active:e,payload:s,label:a})=>{if(e&&s&&s.length){const e=s[0],a=e.value,r=e.payload.index||0;let n=null,d=0;r>0&&void 0!==l[r-1]&&(d=a-l[r-1],n=d>0?"up":d<0?"down":"stable");const c=(a/i*100).toFixed(1);return((a-m)/m*100).toFixed(1),t.jsxs("div",{className:"bg-gradient-to-br from-white to-orange-50 dark:from-gray-800 dark:to-orange-950 p-4 rounded-xl shadow-2xl border-2 border-orange-200 dark:border-orange-700 backdrop-blur-sm min-w-[220px]",children:[t.jsx("div",{className:"mb-2",children:t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:e.payload.date})}),t.jsxs("div",{className:"mb-3 flex items-center gap-2",children:[t.jsx(R,{className:"h-6 w-6 text-orange-500"}),t.jsxs("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:[a," ",a<=1?"jour":"jours"]})]}),n&&t.jsxs("div",{className:"flex items-center gap-2 mb-2 p-2 rounded-lg "+("up"===n?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"down"===n?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:[t.jsx("span",{className:"text-lg",children:"up"===n?"‚Üë":"down"===n?"‚Üì":"‚Üí"}),t.jsxs("span",{className:"text-xs font-semibold",children:["up"===n?`+${d}`:"down"===n?d:"0"," vs hier"]})]}),t.jsxs("div",{className:"space-y-1 text-xs text-gray-600 dark:text-gray-400 pt-2 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"üìä Moyenne:"}),t.jsxs("span",{className:"font-semibold",children:[m,"j"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"üèÜ Record:"}),t.jsxs("span",{className:"font-semibold text-orange-600 dark:text-orange-400",children:[i,"j"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"ÔøΩ % du record:"}),t.jsxs("span",{className:"font-semibold",children:[c,"%"]})]})]}),t.jsx("div",{className:"mt-3 text-center text-xs font-bold py-2 px-3 rounded-lg "+(a>=.8*i?"bg-gradient-to-r from-orange-500 to-red-500 text-white":a>=m?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-blue-500 to-cyan-500 text-white"),children:a>=.8*i?"üî• EN FEU !":a>=m?"‚ú® Super forme !":"üí™ Continue !"})]})}return null};return t.jsxs(n,{className:`${r}`,children:[t.jsxs(d,{children:[t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(R,{className:"h-5 w-5 text-orange-500"}),s]}),a&&t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a})]}),t.jsxs(o,{children:[t.jsx(oe,{width:"100%",height:300,children:t.jsxs(xe,{data:e,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"colorStreak",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#F97316",stopOpacity:.8}),t.jsx("stop",{offset:"95%",stopColor:"#F97316",stopOpacity:.1})]})}),t.jsx(me,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),t.jsx(he,{dataKey:"date",stroke:"#6b7280",tick:{fill:"#6b7280",fontSize:12},className:"dark:stroke-gray-400"}),t.jsx(ue,{stroke:"#6b7280",tick:{fill:"#6b7280"},className:"dark:stroke-gray-400",label:{value:"Jours",angle:-90,position:"insideLeft",style:{fill:"#6b7280"}}}),t.jsx(ge,{content:t.jsx(h,{})}),t.jsx(pe,{type:"monotone",dataKey:"streak",stroke:"#F97316",strokeWidth:2,fillOpacity:1,fill:"url(#colorStreak)",animationDuration:1e3})]})}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Actuel"}),t.jsxs("p",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:["üî• ",x,"j"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Record"}),t.jsxs("p",{className:"text-lg font-bold text-primary",children:[i,"j"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Moyenne"}),t.jsxs("p",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[m,"j"]})]})]})]})]})},Ye=({period:e=7,onPeriodChange:s,className:a=""})=>t.jsxs("div",{className:`flex items-center gap-2 ${a}`,children:[t.jsx(C,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"}),t.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[{value:7,label:"7 jours",short:"7j"},{value:30,label:"30 jours",short:"30j"},{value:90,label:"90 jours",short:"90j"}].map(a=>t.jsxs(x,{variant:e===a.value?"default":"ghost",size:"sm",onClick:()=>s(a.value),className:`\n              text-xs font-medium transition-all duration-200\n              ${e===a.value?"bg-primary text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}\n            `,children:[t.jsx("span",{className:"hidden sm:inline",children:a.label}),t.jsx("span",{className:"sm:hidden",children:a.short})]},a.value))})]}),Xe=({type:e="bar",className:s=""})=>"stat"===e?t.jsx(n,{className:`animate-pulse ${s}`,children:t.jsxs(o,{className:"p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"h-12 w-12 bg-gray-200 dark:bg-gray-700 rounded-xl"}),t.jsx("div",{className:"h-4 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]}),t.jsx("div",{className:"h-8 w-20 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),t.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"})]})}):"donut"===e?t.jsxs(n,{className:`animate-pulse ${s}`,children:[t.jsxs(d,{children:[t.jsx("div",{className:"h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded"}),t.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded mt-2"})]}),t.jsxs(o,{children:[t.jsx("div",{className:"flex items-center justify-center h-[300px]",children:t.jsx("div",{className:"h-48 w-48 bg-gray-200 dark:bg-gray-700 rounded-full"})}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("div",{className:"h-4 w-24 bg-gray-200 dark:bg-gray-700 rounded"}),t.jsx("div",{className:"h-6 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]})})]})]}):"area"===e?t.jsxs(n,{className:`animate-pulse ${s}`,children:[t.jsxs(d,{children:[t.jsx("div",{className:"h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded"}),t.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded mt-2"})]}),t.jsxs(o,{children:[t.jsx("div",{className:"h-[300px] bg-gradient-to-t from-gray-200 to-transparent dark:from-gray-700 rounded"}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 grid grid-cols-3 gap-4",children:[1,2,3].map(e=>t.jsxs("div",{children:[t.jsx("div",{className:"h-4 w-16 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),t.jsx("div",{className:"h-6 w-12 bg-gray-200 dark:bg-gray-700 rounded"})]},e))})]})]}):t.jsxs(n,{className:`animate-pulse ${s}`,children:[t.jsxs(d,{children:[t.jsx("div",{className:"h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded"}),t.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded mt-2"})]}),t.jsxs(o,{children:[t.jsx("div",{className:"h-[300px] flex items-end justify-around gap-2",children:[60,80,45,90,70,55,85].map((e,s)=>t.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-t-lg",style:{height:`${e}%`}},s))}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"h-4 w-16 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),t.jsx("div",{className:"h-6 w-20 bg-gray-200 dark:bg-gray-700 rounded"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"h-4 w-24 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),t.jsx("div",{className:"h-6 w-20 bg-gray-200 dark:bg-gray-700 rounded"})]})]})]})]}),es=({dashboardRef:e,userName:a="Utilisateur",userId:r=null})=>{const[l,i]=s.useState(!1),{toast:n}=g();return t.jsx(x,{onClick:async()=>{if(null==e?void 0:e.current){i(!0);try{const s=await De(e.current,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:1920,windowHeight:e.current.scrollHeight}),t=new p({orientation:"portrait",unit:"mm",format:"a4"}),l=t.internal.pageSize.getWidth(),i=t.internal.pageSize.getHeight(),d=l-20,c=s.height*d/s.width;let o=c,x=10;t.setFontSize(20),t.setTextColor(34,197,94),t.text("E-R√©ussite - Dashboard",10,x),t.setFontSize(10),t.setTextColor(100,100,100),t.text(`G√©n√©r√© le ${(new Date).toLocaleDateString("fr-FR")} √† ${(new Date).toLocaleTimeString("fr-FR")}`,10,x+6),t.text(`Utilisateur: ${a}`,10,x+10),x+=20;const m=s.toDataURL("image/png");if(o<i-30)t.addImage(m,"PNG",10,x,d,c);else for(;o>0;)t.addImage(m,"PNG",10,x,d,c),o-=i-30,o>0&&(t.addPage(),x=10);const h=t.internal.getNumberOfPages();for(let e=1;e<=h;e++)t.setPage(e),t.setFontSize(8),t.setTextColor(150,150,150),t.text(`Page ${e} sur ${h} - E-R√©ussite ¬© ${(new Date).getFullYear()}`,l/2,i-5,{align:"center"});const u=`dashboard-e-reussite-${(new Date).toISOString().split("T")[0]}.pdf`;t.save(u),Me(r||"anonymous",!0),n({title:"‚úÖ Export r√©ussi !",description:`Votre dashboard a √©t√© export√© en PDF : ${u}`})}catch(s){Me(r||"anonymous",!1),n({variant:"destructive",title:"‚ùå Erreur d'export",description:"Une erreur s'est produite lors de la g√©n√©ration du PDF"})}finally{i(!1)}}else n({variant:"destructive",title:"Erreur d'export",description:"Impossible de capturer le dashboard"})},disabled:l,variant:"outline",className:"gap-2 hover:bg-primary hover:text-white transition-colors",children:l?t.jsxs(t.Fragment,{children:[t.jsx(Q,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"G√©n√©ration..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(W,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Exporter en PDF"}),t.jsx("span",{className:"sm:hidden",children:t.jsx(J,{className:"w-4 h-4"})})]})})},ss=e=>{const s=new Date-new Date(e),t=Math.floor(s/1e3),a=Math.floor(t/60),r=Math.floor(a/60),l=Math.floor(r/24);if(t<60)return"√Ä l'instant";if(a<60)return`Il y a ${a} min`;if(r<24){const e=a%60;return e>0?`Il y a ${r}h${e.toString().padStart(2,"0")}`:`Il y a ${r}h`}if(l<7)return`Il y a ${l} jour${l>1?"s":""}`;if(l<30){const e=Math.floor(l/7);return`Il y a ${e} semaine${e>1?"s":""}`}if(l<365){return`Il y a ${Math.floor(l/30)} mois`}{const e=Math.floor(l/365);return`Il y a ${e} an${e>1?"s":""}`}},ts={Sigma:re,Atom:le,Feather:ie,Footprints:ne,Timer:de,Award:ee,Trophy:D,Star:ce,Brain:te},as=e=>{const s={"Math√©matiques":"Sigma","Fran√ßais":"Feather","Physique-Chimie":"Atom",SVT:"Footprints","Histoire-G√©ographie":"BookMarked",Anglais:"MessageSquare",Philosophie:"Brain"};for(const[t,a]of Object.entries(s))if(e.includes(t))return a;return"BookOpen"},rs=async(e,s)=>{try{const t={1:"bfem",2:"bac"}[s]||"bfem",{data:a,error:r}=await h.from("matieres").select("id, name, color").eq("level",t);if(r)return[];if(!a||0===a.length)return[];const l=a.map(async s=>{try{const{data:a,error:r}=await h.from("chapitres").select("id, title").eq("matiere_id",s.id),l={name:s.name.replace(" BFEM","").replace(" BAC",""),progress:0,score:0,icon:as(s.name),color:s.color||"#6B7280"};if(!a||0===a.length)return l;const i=a.length,{data:n,error:d}=await h.from("user_progress").select("chapitre_id").eq("user_id",e).eq("completed",!0).in("chapitre_id",a.map(e=>e.id)),c=(null==n?void 0:n.length)||0,o=i>0?Math.round(c/i*100):0;let x=0;try{const t=a.map(e=>e.id),{data:r}=await h.from("quiz").select("id").in("chapitre_id",t),l=(null==r?void 0:r.map(e=>e.id))||[];let i=[];if(l.length>0){const{data:s}=await h.from("quiz_results").select("score").eq("user_id",e).in("quiz_id",l);i=s||[]}const{data:n}=await h.from("examens").select("id").eq("matiere_id",s.id),d=(null==n?void 0:n.map(e=>e.id))||[];let c=[];if(d.length>0){const{data:s}=await h.from("exam_results").select("score").eq("user_id",e).in("exam_id",d);c=s||[]}const o=[...(null==i?void 0:i.map(e=>e.score))||[],...(null==c?void 0:c.map(e=>e.score))||[]];o.length>0&&(x=Math.round(o.reduce((e,s)=>e+s,0)/o.length))}catch(t){}return{...l,progress:o,score:x}}catch(t){return{name:s.name.replace(" BFEM","").replace(" BAC",""),progress:0,score:0,icon:as(s.name),color:s.color||"#6B7280"}}});return(await Promise.all(l)).sort((e,s)=>s.progress-e.progress)}catch(t){return[]}},ls=async()=>{try{const{default:s}=await e(()=>import("./index-80385b81.js").then(e=>e.O),["assets/index-80385b81.js","assets/vendor-supabase-1d8f37f5.js","assets/vendor-react-470eca1f.js","assets/vendor-ui-297a683c.js","assets/vendor-router-da2b77bd.js","assets/vendor-charts-0ffd78b1.js","assets/index-10a14d87.css"]),t=[],{data:a}=await s.gamification.getActiveChallenges();a&&a.length>0&&a.forEach(e=>{t.push({title:e.name,date:e.end_date,type:"challenge",description:e.description})});const{data:r}=await s.exam.getExams();return r&&r.length>0&&r.slice(0,2).forEach(e=>{t.push({title:e.title,date:new Date(Date.now()+6048e5).toISOString().split("T")[0],type:"exam",description:`Dur√©e: ${e.duration_minutes} minutes`})}),t.sort((e,s)=>new Date(e.date)-new Date(s.date)),t.slice(0,3)}catch(s){return[]}},is=async(s,t)=>{try{const{default:t}=await e(()=>import("./index-80385b81.js").then(e=>e.O),["assets/index-80385b81.js","assets/vendor-supabase-1d8f37f5.js","assets/vendor-react-470eca1f.js","assets/vendor-ui-297a683c.js","assets/vendor-router-da2b77bd.js","assets/vendor-charts-0ffd78b1.js","assets/index-10a14d87.css"]),a=new Date;a.setDate(a.getDate()-7);const{data:r}=await t.progress.getUserProgress(s,{from_date:a.toISOString()}),l=Array(7).fill(0);r&&r.length>0&&r.forEach(e=>{const s=6-Math.floor((Date.now()-new Date(e.last_accessed_at))/864e5);s>=0&&s<7&&(l[s]+=(e.time_spent||30)/60)});const{data:i}=await t.quiz.getUserQuizResults(s),n=i&&i.length>0?i.slice(0,7).reverse().map(e=>e.score):[0],d="18:00-20:00",c=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"][l.indexOf(Math.max(...l))]||"Mardi";return{dailyStudyTime:l,performanceTrend:n,favoriteStudyTime:d,mostProductiveDay:c}}catch(a){return{dailyStudyTime:[0,0,0,0,0,0,0],performanceTrend:[0],favoriteStudyTime:"18:00-20:00",mostProductiveDay:"Mardi"}}},ns=()=>{var m,u,p,M;const{user:A,userProfile:q,loading:E,getGamificationStatus:T,getLearningRecommendations:B}=j(),L=l(),{toast:O}=g(),I=s.useRef(null),[V,H]=s.useState(null),[Q,W]=s.useState(null),[J,re]=s.useState([]),[le,ie]=s.useState(!0),[ne,de]=s.useState(null),[ce,oe]=s.useState([]),[xe,me]=s.useState([]),[he,ue]=s.useState([]),[ge,pe]=s.useState(!1),[je,be]=s.useState([]),[fe,ve]=s.useState(!1),[ye,we]=s.useState(null),[ke,_e]=s.useState(7),[Se,Ce]=s.useState([]),[ze,De]=s.useState([]),[Me,Fe]=s.useState([]),[Ve,Ge]=s.useState(!1);s.useEffect(()=>{if(E||A||L("/login"),A&&q){He();const e=(null==A?void 0:A.id)||(null==A?void 0:A.email)||"anonymous";$e(e,"overview");const s=Date.now();return Pe(e),()=>{const t=Math.floor((Date.now()-s)/1e3);Ae(e,t)}}},[A,q,E,L]);const He=async()=>{var s,t,a,r;ie(!0);try{const i=await T();W(i);const n=await B();re(n);const{default:d}=await e(()=>import("./index-80385b81.js").then(e=>e.O),["assets/index-80385b81.js","assets/vendor-supabase-1d8f37f5.js","assets/vendor-react-470eca1f.js","assets/vendor-ui-297a683c.js","assets/vendor-router-da2b77bd.js","assets/vendor-charts-0ffd78b1.js","assets/index-10a14d87.css"]),{dbHelpers:c}=await e(()=>import("./index-80385b81.js").then(e=>e.Q),["assets/index-80385b81.js","assets/vendor-supabase-1d8f37f5.js","assets/vendor-react-470eca1f.js","assets/vendor-ui-297a683c.js","assets/vendor-router-da2b77bd.js","assets/vendor-charts-0ffd78b1.js","assets/index-10a14d87.css"]),[o,x,m]=await Promise.all([c.getUserPoints(A.id),c.getUserBadges(A.id),c.getLeaderboard(10)]);de(o),oe(x||[]),me(m||[]),pe(!0);const u=await c.getUserPointsHistory(A.id,7);ue(u||[]),pe(!1),ve(!0);const g=await c.ensureUserHasChallenges(A.id);be(g||[]),ve(!1);const p=await(async e=>{try{const{data:s,error:t}=await h.from("exam_results").select("*").eq("user_id",e).order("completed_at",{ascending:!1});if(t)return{totalExams:0,averageScore:0,bestScore:0,totalTime:0,recentExams:[]};const a=(null==s?void 0:s.length)||0,r=a>0?Math.round(s.reduce((e,s)=>e+s.score,0)/a):0,l=a>0?Math.max(...s.map(e=>e.score)):0,i=(null==s?void 0:s.reduce((e,s)=>e+(s.time_taken||0),0))||0,n=[];if(s&&s.length>0)for(const e of s.slice(0,5)){const{data:s}=await h.from("examens").select("title, type, difficulty").eq("id",e.exam_id).single();s&&n.push({id:e.id,title:s.title,score:e.score,type:s.type,difficulty:s.difficulty,time_taken:e.time_taken,completed_at:e.completed_at})}return{totalExams:a,averageScore:r,bestScore:l,totalTime:i,recentExams:n}}catch(s){return{totalExams:0,averageScore:0,bestScore:0,totalTime:0,recentExams:[]}}})(A.id);we(p);const[j,b]=await Promise.all([h.from("user_progress").select("*").eq("user_id",A.id),h.from("user_badges").select("*").eq("user_id",A.id)]),{data:f}=await h.from("quiz_results").select("\n          id,\n          quiz_id,\n          score,\n          correct_answers,\n          total_questions,\n          time_taken,\n          completed_at,\n          quiz:quiz_id (\n            id,\n            title,\n            chapitres:chapitre_id (\n              matieres:matiere_id (name)\n            )\n          )\n        ").eq("user_id",A.id).order("completed_at",{ascending:!1}).limit(5),N={data:f||[]},v=(null==f?void 0:f.length)||0;let y=0;try{const{data:e}=await h.from("quiz_results").select("score").eq("user_id",A.id),{data:s}=await h.from("exam_results").select("score").eq("user_id",A.id),t=[...(null==e?void 0:e.map(e=>e.score))||[],...(null==s?void 0:s.map(e=>e.score))||[]];t.length>0&&(y=Math.round(t.reduce((e,s)=>e+s,0)/t.length))}catch(l){}const w=(null==(s=j.data)?void 0:s.reduce((e,s)=>{const t=s.time_spent||0;return 0===t&&s.completed?e+1800:e+t},0))||0,k=(null==(t=j.data)||t.filter(e=>e.completed).length,new Set((null==(a=j.data)?void 0:a.map(e=>{var s;return null==(s=e.lecon)?void 0:s.chapitre_id}))||[]).size),_=[];if(ye&&ye.recentExams&&ye.recentExams.length>0&&ye.recentExams.slice(0,3).forEach(e=>{const s={facile:"üü¢",moyen:"üü°",difficile:"üî¥"}[e.difficulty]||"‚ö™";_.push({id:`exam-${e.id}`,type:"exam_completed",title:`${s} Examen: ${e.title}`,score:e.score,subject:"blanc"===e.type?"Examen blanc":"Examen de mati√®re",timestamp:ss(e.completed_at),timestampDate:new Date(e.completed_at),icon:"Target"})}),j.data&&j.data.length>0){const e=j.data.filter(e=>e.completed&&e.completed_at).sort((e,s)=>new Date(s.completed_at)-new Date(e.completed_at)).slice(0,3);for(const s of e){const{data:e,error:t}=await h.from("chapitres").select("title, matiere:matieres(name)").eq("id",s.chapitre_id).single();e&&_.push({id:`chapitre-${s.id}`,type:"chapter_completed",title:`Chapitre compl√©t√©: ${e.title}`,subject:(null==(r=e.matiere)?void 0:r.name)||"Mati√®re",timestamp:ss(s.completed_at),timestampDate:new Date(s.completed_at),icon:"BookOpen"})}}N.data&&N.data.length>0&&N.data.slice(0,3).forEach(e=>{var s,t,a,r;const l=Math.round(e.score||0);_.push({id:`quiz-${e.id}`,type:"quiz_completed",title:`Quiz: ${(null==(s=e.quiz)?void 0:s.title)||"Quiz"}`,score:l,subject:(null==(r=null==(a=null==(t=e.quiz)?void 0:t.chapitres)?void 0:a.matieres)?void 0:r.name)||"Mati√®re",timestamp:ss(e.completed_at),timestampDate:new Date(e.completed_at),icon:"Target"})}),ce.data&&ce.data.length>0&&ce.data.slice(0,2).forEach(e=>{var s,t;_.push({id:e.id,type:"badge_earned",title:`Badge: ${(null==(s=e.badge)?void 0:s.name)||"Badge"}`,description:(null==(t=e.badge)?void 0:t.description)||"",timestamp:ss(e.earned_at),timestampDate:new Date(e.earned_at),icon:"Award"})}),_.sort((e,s)=>{const t=e.timestampDate||new Date(0);return(s.timestampDate||new Date(0))-t});const S=_.slice(0,5),C={stats:{totalStudyTime:Math.round(w/60),averageScore:parseFloat(y)||0,coursesStarted:k,coursesCompleted:Math.floor(.4*k),quizCompleted:v,currentStreak:(null==o?void 0:o.current_streak)||0,weeklyGoal:8,weeklyProgress:parseFloat((w/3600).toFixed(1)),examsCompleted:(null==ye?void 0:ye.totalExams)||0,examAverageScore:(null==ye?void 0:ye.averageScore)||0,examBestScore:(null==ye?void 0:ye.bestScore)||0,examTotalTime:(null==ye?void 0:ye.totalTime)||0},recentActivity:S.length>0?S:[{id:1,type:"lesson_started",title:"Commencez votre premier cours",subject:"E-R√©ussite",timestamp:"Aujourd'hui",icon:"BookOpen"}],subjectProgress:await rs(A.id,null==q?void 0:q.level),upcomingEvents:await ls(),studyAnalytics:await is(A.id,j.data)};H(C)}catch(l){O({variant:"destructive",title:"Erreur de chargement",description:"Impossible de charger les donn√©es du tableau de bord"})}finally{ie(!1)}};s.useEffect(()=>{if(A&&ne){(async()=>{if(A){Ge(!0);try{const e=new Date;e.setDate(e.getDate()-ke);const{data:s}=await h.from("user_progress").select("\n          time_spent,\n          chapitres:chapitre_id (\n            matieres:matiere_id (\n              name,\n              color\n            )\n          )\n        ").eq("user_id",A.id),t={};null==s||s.forEach(e=>{var s,a,r,l;const i=(null==(a=null==(s=e.chapitres)?void 0:s.matieres)?void 0:a.name)||"Autre",n=(null==(l=null==(r=e.chapitres)?void 0:r.matieres)?void 0:l.color)||"#6B7280";t[i]||(t[i]={name:i,value:0,color:n}),t[i].value+=Math.round((e.time_spent||0)/3600)});const a=Object.values(t).filter(e=>e.value>0);Ce(a);const r={},l=["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],i=(null==s?void 0:s.reduce((e,s)=>e+Math.round((s.time_spent||0)/60),0))||0,n=Math.round(i/7);for(let x=6;x>=0;x--){const e=new Date;e.setDate(e.getDate()-x),r[e.toLocaleDateString("fr-FR")]={day:l[e.getDay()],date:e,minutes:n}}const d=Object.values(r).sort((e,s)=>e.date-s.date).map(e=>({day:e.day,minutes:e.minutes}));De(d);const{data:c}=await h.from("streak_history").select("date, streak_value").eq("user_id",A.id).gte("date",e.toISOString().split("T")[0]).order("date",{ascending:!0}),o=(c||[]).map(e=>({date:new Date(e.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short"}),streak:e.streak_value}));Fe(o)}catch(e){}finally{Ge(!1)}}})();const e=(null==A?void 0:A.id)||(null==A?void 0:A.email)||"anonymous";(null==Se?void 0:Se.length)>0&&qe("donut",e),(null==ze?void 0:ze.length)>0&&qe("bar",e),(null==Me?void 0:Me.length)>0&&qe("area",e)}},[ke,A,ne]);return E||le||!A||!V?t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),t.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Chargement de votre tableau de bord..."})]})}):t.jsxs(t.Fragment,{children:[t.jsxs(a,{children:[t.jsx("title",{children:"Tableau de bord - E-R√©ussite"}),t.jsx("meta",{name:"description",content:"Votre tableau de bord E-R√©ussite - Suivez votre progression et acc√©dez √† vos cours."})]}),t.jsx(Oe,{userId:null==A?void 0:A.id,loginCount:(null==q?void 0:q.login_count)||0,userProfile:q}),t.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[t.jsx(i,{}),t.jsx(Ie,{}),t.jsxs("main",{ref:I,className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsx(Ne.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:t.jsx("div",{className:"bg-gradient-to-r from-primary to-blue-600 rounded-2xl p-6 text-white",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:(()=>{var e;const s=(new Date).getHours(),t=(null==q?void 0:q.full_name)||(null==(e=null==A?void 0:A.email)?void 0:e.split("@")[0])||"√âtudiant";return s<12?`Bonjour ${t} !`:s<18?`Bon apr√®s-midi ${t} !`:`Bonsoir ${t} !`})()}),t.jsx("p",{className:"text-blue-100 mb-4",children:"Continuez sur votre lanc√©e ! Vous progressez excellemment."}),t.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[ne&&t.jsx(Qe,{currentStreak:ne.current_streak||0,longestStreak:ne.longest_streak||0,lastActivityDate:ne.last_activity_date,variant:"minimal",showProgress:!1,className:"scale-110"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(z,{className:"w-4 h-4 text-green-300"}),t.jsxs("span",{children:[V.stats.averageScore,"% de moyenne"]})]})]})]}),ne&&t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-white/20 flex items-center justify-center mb-2",children:t.jsx("span",{className:"text-2xl font-bold",children:ne.level||1})}),t.jsxs("p",{className:"text-xs text-blue-100",children:["Niveau ",ne.level||1]}),t.jsxs("p",{className:"text-xs text-blue-200 font-semibold",children:[ne.total_points||0," points"]}),t.jsxs("div",{className:"mt-2 w-24",children:[t.jsx("div",{className:"h-1.5 bg-white/20 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-yellow-300 transition-all duration-300",style:{width:`${Math.min(100,(ne.total_points||0)%100)}%`}})}),t.jsxs("p",{className:"text-xs text-blue-100 mt-1",children:[ne.points_to_next_level||100," pts restants"]})]})]})]})})}),t.jsxs(y,{defaultValue:"overview",className:"space-y-6",children:[t.jsxs(w,{className:"grid w-full grid-cols-4 overflow-x-auto scrollbar-hide gap-1",children:[t.jsxs(k,{value:"overview",className:"flex items-center gap-2",children:[t.jsx(K,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Vue d'ensemble"})]}),t.jsxs(k,{value:"progress",className:"flex items-center gap-2",children:[t.jsx(S,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Progression"})]}),t.jsxs(k,{value:"analytics",className:"flex items-center gap-2",children:[t.jsx(Z,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Analytiques"})]}),t.jsxs(k,{value:"achievements",className:"flex items-center gap-2",children:[t.jsx(D,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Succ√®s"})]})]}),t.jsxs(_,{value:"overview",className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx(We,{title:"Quiz compl√©t√©s",value:((null==ne?void 0:ne.quizzes_completed)||V.stats.quizCompleted||0).toString(),change:"+5 cette semaine",changeType:"increase",icon:U,color:"blue"}),t.jsx(We,{title:"Temps d'√©tude",value:`${Math.floor((V.stats.totalStudyTime||0)/60)}h${Math.floor((V.stats.totalStudyTime||0)%60).toString().padStart(2,"0")}`,change:"+2h30 vs semaine derni√®re",changeType:"increase",icon:$,color:"green"}),t.jsx(We,{title:"Streak actuel",value:`${(null==ne?void 0:ne.current_streak)||V.stats.currentStreak||0}j`,change:((null==ne?void 0:ne.current_streak)||V.stats.currentStreak||0)>0?"En feu ! üî•":"Commencer aujourd'hui",changeType:((null==ne?void 0:ne.current_streak)||V.stats.currentStreak||0)>0?"increase":"decrease",icon:R,color:"orange"}),t.jsx(We,{title:"Score moyen",value:`${Math.round(V.stats.averageScore||0)}%`,change:"+3.5% vs mois dernier",changeType:"increase",icon:S,color:"purple"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Statistiques d√©taill√©es"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(es,{dashboardRef:I,userName:(null==q?void 0:q.full_name)||(null==(m=null==A?void 0:A.email)?void 0:m.split("@")[0])||"Utilisateur",userId:(null==A?void 0:A.id)||(null==A?void 0:A.email)}),t.jsx(Ye,{period:ke,onPeriodChange:e=>{_e(e);const s=(null==A?void 0:A.id)||(null==A?void 0:A.email)||"anonymous";Ee(e,s)}})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Ve?t.jsx(Xe,{type:"donut"}):t.jsx(Je,{data:Se,title:"R√©partition par mati√®re",subtitle:`${ke} derniers jours`}),Ve?t.jsx(Xe,{type:"bar"}):t.jsx(Ke,{data:ze,title:"Temps d'√©tude quotidien",subtitle:`${ke} derniers jours`})]}),Ve?t.jsx(Xe,{type:"area"}):t.jsx(Ze,{data:Me,title:"√âvolution de votre streak",subtitle:`${ke} derniers jours`}),ye&&ye.totalExams>0&&t.jsxs(n,{className:"border-2 border-primary/20 bg-gradient-to-br from-primary/5 to-blue-50 dark:from-primary/10 dark:to-blue-950/20 dark:bg-slate-800 dark:border-white/30 shadow-[0_0_16px_0_rgba(34,197,94,0.18)] dark:shadow-[0_0_35px_rgba(34,197,94,0.25)]",children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2 dark:text-slate-100",children:[t.jsx(z,{className:"w-5 h-5 text-primary"}),"üìù Statistiques des Examens"]})}),t.jsxs(o,{children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[t.jsx("p",{className:"text-3xl font-bold text-primary",children:ye.totalExams}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-1",children:"Examens pass√©s"})]}),t.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[t.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[ye.averageScore,"%"]}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-1",children:"Score moyen"})]}),t.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[t.jsxs("p",{className:"text-3xl font-bold text-yellow-600",children:[ye.bestScore,"%"]}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-1",children:"Meilleur score"})]}),t.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm",children:[t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:Math.floor(ye.totalTime/60)}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-1",children:"Minutes totales"})]})]}),t.jsx("div",{className:"mt-4 flex justify-center",children:t.jsxs(x,{onClick:()=>L("/exam"),className:"gap-2",children:[t.jsx(z,{className:"w-4 h-4"}),"Passer un nouvel examen"]})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-[0_0_16px_0_rgba(34,197,94,0.18)] dark:shadow-[0_0_24px_0_rgba(34,197,94,0.25)]",children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2 dark:text-slate-100",children:[t.jsx(Z,{className:"w-5 h-5"}),"Progression par mati√®re"]})}),t.jsx(o,{className:"space-y-4",children:V.subjectProgress&&V.subjectProgress.length>0?V.subjectProgress.map((e,s)=>{const a=ts[e.icon]||U,r=e.color||"#6B7280",l={backgroundColor:`${r}15`},i={color:r};return t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:l,children:t.jsx(a,{className:"w-5 h-5",style:i})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"font-medium",children:e.name}),t.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-300",children:[e.progress,"%"]})]}),t.jsx("div",{className:"h-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${e.progress}%`,backgroundColor:r}})}),t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:e.score>0?`Derni√®re note: ${e.score}%`:"Aucun quiz r√©alis√©"})]})]},s)}):t.jsxs("div",{className:"text-center py-8 text-slate-500",children:[t.jsx(U,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"font-medium",children:"Aucune mati√®re disponible"}),t.jsx("p",{className:"text-sm",children:"Les mati√®res appara√Ætront ici une fois que vous commencerez vos cours"})]})})]})}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-[0_0_16px_0_rgba(34,197,94,0.18)] dark:shadow-[0_0_24px_0_rgba(34,197,94,0.25)]",children:[t.jsxs(d,{className:"flex flex-row items-center justify-between",children:[t.jsxs(c,{className:"flex items-center gap-2 dark:text-slate-100",children:[t.jsx(Y,{className:"w-5 h-5"}),"Activit√© r√©cente"]}),t.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>L("/historique"),className:"text-blue-600 hover:text-blue-700",children:["Voir tout",t.jsx(X,{className:"w-4 h-4 ml-1"})]})]}),t.jsx(o,{className:"space-y-4",children:V.recentActivity.map((e,s)=>{const a="Target"===e.icon?z:"BookOpen"===e.icon?U:ee;return t.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer group",onClick:()=>{return L("exam_completed"===(s=e).type?"/exam":"quiz_completed"===s.type?"/quiz":"chapter_completed"===s.type?"/my-courses":"badge_earned"===s.type?"/badges":"/historique");var s},children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:t.jsx(a,{className:"w-4 h-4 text-slate-600 dark:text-slate-300 group-hover:text-blue-600 transition-colors"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-sm group-hover:text-blue-600 transition-colors",children:e.title}),void 0!==e.score&&t.jsxs("p",{className:"text-xs font-semibold "+(e.score>=70?"text-green-600":e.score>=50?"text-yellow-600":"text-red-600"),children:["Score: ",e.score,"%"]}),e.subject&&t.jsx("p",{className:"text-xs text-slate-500",children:e.subject}),t.jsx("p",{className:"text-xs text-slate-400",children:e.timestamp})]}),t.jsx(X,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors"})]},s)})})]})]}),t.jsx(Re,{data:he,loading:ge}),A&&t.jsx(Le,{userId:A.id}),t.jsx(Be,{challenges:je,onClaimReward:async s=>{try{const{dbHelpers:t}=await e(()=>import("./index-80385b81.js").then(e=>e.Q),["assets/index-80385b81.js","assets/vendor-supabase-1d8f37f5.js","assets/vendor-react-470eca1f.js","assets/vendor-ui-297a683c.js","assets/vendor-router-da2b77bd.js","assets/vendor-charts-0ffd78b1.js","assets/index-10a14d87.css"]),a=await t.claimChallengeRewards(A.id,s);if(!a.success)throw new Error(a.error||"Erreur lors de la r√©clamation");O({title:"üéâ R√©compenses r√©clam√©es !",description:`Vous avez gagn√© ${a.reward_points} points !`}),be(e=>e.map(e=>e.id===s?{...e,status:"claimed",rewards_claimed:!0}:e)),He()}catch(t){O({variant:"destructive",title:"Erreur",description:t.message||"Impossible de r√©clamer les r√©compenses"})}},loading:fe}),xe.length>0&&t.jsxs(n,{className:"border-2 shadow-[0_0_16px_0_rgba(34,197,94,0.18)] dark:shadow-[0_0_24px_0_rgba(34,197,94,0.25)]",children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2",children:[t.jsx(se,{className:"w-5 h-5"}),t.jsx("span",{className:"text-slate-900 dark:text-green-300",children:"Classement"}),t.jsx("span",{className:"text-sm font-normal ml-auto px-2 py-0.5 rounded-full bg-green-100 dark:bg-green-900/60 text-green-700 dark:text-green-300 border border-green-300 dark:border-green-700 shadow-sm",children:"Top 10"})]})}),t.jsxs(o,{children:[t.jsx("div",{className:"space-y-3",children:xe.map((e,s)=>{var a,r,l,i;const n=e.user_id===(null==A?void 0:A.id);return t.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-colors ${n?"bg-primary/10 border-2 border-primary":"bg-slate-50 hover:bg-slate-100 dark:bg-slate-800 dark:hover:bg-slate-700 border border-green-100 dark:border-green-900/40"} shadow-[0_0_8px_0_rgba(34,197,94,0.10)] dark:shadow-[0_0_12px_0_rgba(34,197,94,0.18)]`,children:[t.jsx("div",{className:"w-8 text-center font-bold text-lg",children:s<3?["ü•á","ü•à","ü•â"][s]:`#${s+1}`}),t.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center text-white font-bold",children:(null==(l=null==(r=null==(a=e.profiles)?void 0:a.full_name)?void 0:r.charAt(0))?void 0:l.toUpperCase())||"?"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"font-semibold "+(n?"text-primary":"text-slate-900 dark:text-white"),children:[(null==(i=e.profiles)?void 0:i.full_name)||"Utilisateur",n&&t.jsx("span",{className:"text-xs ml-2 text-primary",children:"(Vous)"})]}),t.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300",children:[t.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-100 dark:bg-green-900/60 border border-green-300 dark:border-green-700 mr-1",children:["Niveau ",e.level]}),t.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/60 border border-blue-300 dark:border-blue-700 mr-1",children:[e.quizzes_completed||0," quiz"]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"font-bold text-lg text-yellow-600",children:e.total_points}),t.jsx("p",{className:"text-xs text-slate-500",children:"points"})]})]})]},e.user_id)})}),t.jsx("div",{className:"mt-4 text-center",children:t.jsxs(x,{variant:"outline",size:"sm",onClick:()=>L("/badges"),className:"gap-2",children:[t.jsx(D,{className:"w-4 h-4"}),"Voir tous les badges"]})})]})]}),J.length>0&&t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsx(d,{children:t.jsxs(c,{className:"flex items-center gap-2 dark:text-slate-100",children:[t.jsx(te,{className:"w-5 h-5"}),"Recommandations personnalis√©es"]})}),t.jsx(o,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:J.slice(0,4).map((e,s)=>t.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 dark:border-white/10 border-2 dark:shadow-[0_0_20px_rgba(255,255,255,0.2)] rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(P,{className:"w-4 h-4 text-yellow-500"}),t.jsx("h4",{className:"font-semibold text-sm dark:text-white",children:e.title})]}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-3",children:e.description}),t.jsx(x,{size:"sm",variant:"outline",onClick:()=>{return s=e.title,void O({title:"üöß Bient√¥t disponible",description:`${s} üöÄ`});var s},children:"Voir les d√©tails"})]},s))})})]})]}),t.jsxs(_,{value:"progress",className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsx(d,{children:t.jsx(c,{className:"dark:text-slate-100",children:"Objectif hebdomadaire"})}),t.jsx(o,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:"Progression"}),t.jsxs("span",{className:"font-semibold",children:[V.stats.weeklyProgress,"h / ",V.stats.weeklyGoal,"h"]})]}),t.jsx(v,{value:V.stats.weeklyProgress/V.stats.weeklyGoal*100,className:"h-3"}),t.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:["Il vous reste ",V.stats.weeklyGoal-V.stats.weeklyProgress,"h pour atteindre votre objectif !"]})]})})]}),Q&&t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsx(d,{children:t.jsx(c,{className:"dark:text-slate-100",children:"Progression de niveau"})}),t.jsx(o,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{children:["Niveau ",Q.level]}),t.jsxs("span",{className:"font-semibold",children:[Q.points," / ",Q.nextLevelPoints," pts"]})]}),t.jsx(v,{value:Q.progressToNextLevel,className:"h-3"}),t.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[Q.pointsToNextLevel," points pour le niveau suivant"]})]})})]})]}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsxs(d,{children:[t.jsx(c,{className:"dark:text-slate-100",children:"üìÖ Timeline de Progression"}),t.jsx(b,{children:"Historique de vos activit√©s r√©centes"})]}),t.jsx(o,{children:V.recentActivity&&V.recentActivity.length>0?t.jsx("div",{className:"space-y-4",children:V.recentActivity.slice(0,10).map((e,s)=>{const a=e.timestamp||e.created_at,r=a?new Date(a):null,l=r&&!isNaN(r.getTime()),i=l?f(r,{addSuffix:!0,locale:N}):"Date inconnue",n=l?Te(r,"dd MMM yyyy HH:mm",{locale:N}):"N/A";return t.jsxs("div",{className:"flex items-start gap-4 pb-4 border-b dark:border-slate-700 last:border-0",children:[t.jsxs("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:["quiz"===e.type&&t.jsx(te,{className:"w-5 h-5 text-white"}),"lesson"===e.type&&t.jsx(U,{className:"w-5 h-5 text-white"}),"badge"===e.type&&t.jsx(ee,{className:"w-5 h-5 text-white"}),!["quiz","lesson","badge"].includes(e.type)&&t.jsx(S,{className:"w-5 h-5 text-white"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium dark:text-slate-100",children:e.title}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:e.description}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx($,{className:"w-3 h-3 text-slate-400"}),t.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",title:n,children:i})]})]})]},s)})}):t.jsxs("div",{className:"text-center py-8 text-slate-500",children:[t.jsx($,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Aucune activit√© r√©cente"})]})})]}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsxs(d,{children:[t.jsx(c,{className:"dark:text-slate-100",children:"üìä Statistiques par Mati√®re"}),t.jsx(b,{children:"D√©tails de votre progression par mati√®re"})]}),t.jsx(o,{children:t.jsx("div",{className:"space-y-4",children:V.subjectProgress.map((e,s)=>{const a=ts[e.icon]||U,r=e.color||"#6B7280",l={color:r};return t.jsxs("div",{className:"p-4 rounded-lg bg-slate-50 dark:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(a,{style:l,className:"w-5 h-5"}),t.jsx("h4",{className:"font-semibold dark:text-slate-100",children:e.name})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Progression"}),t.jsxs("p",{className:"font-semibold text-lg",style:{color:r},children:[e.progress,"%"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Chapitres"}),t.jsxs("p",{className:"font-semibold text-lg dark:text-slate-100",children:[e.completedChapters,"/",e.totalChapters]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Quiz r√©ussis"}),t.jsx("p",{className:"font-semibold text-lg dark:text-slate-100",children:e.quizzesPassed||0})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Score moyen"}),t.jsxs("p",{className:"font-semibold text-lg dark:text-slate-100",children:[e.averageScore||0,"%"]})]})]}),t.jsx("div",{className:"mt-3",children:t.jsx("div",{className:"h-2 bg-slate-200 dark:bg-slate-600 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${e.progress}%`,backgroundColor:r}})})})]},s)})})})]}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsxs(d,{children:[t.jsx(c,{className:"dark:text-slate-100",children:"‚úÖ Chapitres Compl√©t√©s R√©cemment"}),t.jsx(b,{children:"Vos derniers accomplissements"})]}),t.jsx(o,{children:V.completedChapters&&V.completedChapters.length>0?t.jsx("div",{className:"space-y-3",children:V.completedChapters.slice(0,8).map((e,s)=>{const a=e.completed_at||e.created_at,r=a?new Date(a):null,l=r&&!isNaN(r.getTime())?f(r,{addSuffix:!0,locale:N}):"Date inconnue";return t.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-slate-50 dark:bg-slate-700/50 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:t.jsx(F,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium dark:text-slate-100",children:e.name}),t.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:e.subject})]})]}),t.jsx("div",{className:"text-right",children:t.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400",children:[t.jsx($,{className:"w-3 h-3"}),t.jsx("span",{children:l})]})})]},s)})}):t.jsxs("div",{className:"text-center py-8 text-slate-500",children:[t.jsx(U,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Aucun chapitre compl√©t√©"}),t.jsx("p",{className:"text-sm mt-1",children:"Commencez √† √©tudier pour voir vos progr√®s !"})]})})]})]}),t.jsx(_,{value:"analytics",className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsx(d,{children:t.jsx(c,{className:"dark:text-slate-100",children:"Habitudes d'√©tude"})}),t.jsxs(o,{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Heure favorite"}),t.jsx("span",{className:"font-semibold",children:V.studyAnalytics.favoriteStudyTime})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Jour le plus productif"}),t.jsx("span",{className:"font-semibold",children:V.studyAnalytics.mostProductiveDay})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:"Temps moyen par session"}),t.jsx("span",{className:"font-semibold",children:"45 minutes"})]})]})]}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsx(d,{children:t.jsx(c,{className:"dark:text-slate-100",children:"√âv√©nements √† venir"})}),t.jsx(o,{className:"space-y-3",children:V.upcomingEvents.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[t.jsx(C,{className:"w-5 h-5 text-slate-500"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-sm",children:e.title}),t.jsx("p",{className:"text-xs text-slate-500",children:e.date})]}),t.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+("exam"===e.type?"bg-red-100 text-red-700":"quiz"===e.type?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"),children:e.type})]},s))})]})]})}),t.jsxs(_,{value:"achievements",className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs(n,{className:"text-center p-4 bg-gradient-to-br from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 border-yellow-200 dark:border-yellow-700",children:[t.jsx(D,{className:"w-8 h-8 mx-auto mb-2 text-yellow-600"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-400",children:(null==(u=null==Q?void 0:Q.recentBadges)?void 0:u.length)||0}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300",children:"Badges obtenus"})]}),t.jsxs(n,{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 border-blue-200 dark:border-blue-700",children:[t.jsx(ee,{className:"w-8 h-8 mx-auto mb-2 text-blue-600"}),t.jsx("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-400",children:(null==Q?void 0:Q.level)||1}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300",children:"Niveau actuel"})]}),t.jsxs(n,{className:"text-center p-4 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-green-200 dark:border-green-700",children:[t.jsx(z,{className:"w-8 h-8 mx-auto mb-2 text-green-600"}),t.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:(null==Q?void 0:Q.points)||0}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300",children:"Points totaux"})]}),t.jsxs(n,{className:"text-center p-4 bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 border-orange-200 dark:border-orange-700",children:[t.jsx(R,{className:"w-8 h-8 mx-auto mb-2 text-orange-600"}),t.jsx("p",{className:"text-2xl font-bold text-orange-700 dark:text-orange-400",children:(null==Q?void 0:Q.streak)||0}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300",children:"Jours de s√©rie"})]})]}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg",children:[t.jsxs(d,{children:[t.jsxs(c,{className:"dark:text-slate-100 flex items-center gap-2",children:[t.jsx(D,{className:"w-5 h-5 text-yellow-600"}),"üèÜ Badges R√©cents"]}),t.jsx(b,{children:"Vos derniers accomplissements"})]}),t.jsx(o,{children:(null==Q?void 0:Q.recentBadges)&&Q.recentBadges.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Q.recentBadges.map((e,s)=>t.jsx(Ne.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*s},children:t.jsxs(n,{className:"text-center p-6 dark:bg-slate-700/50 dark:border-white/10 border-2 shadow-lg hover:shadow-xl transition-shadow",children:[t.jsx("div",{className:"w-16 h-16 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(D,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"})}),t.jsx("h3",{className:"font-bold mb-2 dark:text-slate-100",children:e.badge_name}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-4",children:e.badge_description}),t.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900/40 text-yellow-700 dark:text-yellow-300 px-2 py-1 rounded-full",children:e.badge_rarity}),e.earned_at&&t.jsxs("div",{className:"flex items-center justify-center gap-1 mt-3 text-xs text-slate-500",children:[t.jsx($,{className:"w-3 h-3"}),t.jsx("span",{children:new Date(e.earned_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]})]})},s))}):t.jsxs("div",{className:"text-center py-12 text-slate-500",children:[t.jsx(D,{className:"w-16 h-16 mx-auto mb-3 opacity-30"}),t.jsx("p",{className:"text-lg",children:"Aucun badge obtenu"}),t.jsx("p",{className:"text-sm mt-2",children:"Compl√©tez des d√©fis pour gagner des badges !"})]})})]}),t.jsxs(n,{className:"dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg",children:[t.jsxs(d,{children:[t.jsxs(c,{className:"dark:text-slate-100 flex items-center gap-2",children:[t.jsx(z,{className:"w-5 h-5 text-blue-600"}),"üéØ Prochains Objectifs"]}),t.jsx(b,{children:"Badges √† d√©bloquer"})]}),t.jsx(o,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:t.jsx(U,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold dark:text-slate-100",children:"Lecteur Assidu"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Compl√©tez 10 le√ßons"})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-slate-500",children:"Progress"}),t.jsxs("p",{className:"font-bold text-blue-600",children:[(null==(p=null==V?void 0:V.stats)?void 0:p.lessonsCompleted)||0,"/10"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:t.jsx(te,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold dark:text-slate-100",children:"Expert Quiz"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"R√©ussissez 25 quiz"})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-slate-500",children:"Progress"}),t.jsxs("p",{className:"font-bold text-green-600",children:[(null==(M=null==V?void 0:V.stats)?void 0:M.quizzesCompleted)||0,"/25"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:t.jsx(R,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold dark:text-slate-100",children:"S√©rie de 7 Jours"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"√âtudiez 7 jours d'affil√©e"})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-slate-500",children:"Progress"}),t.jsxs("p",{className:"font-bold text-purple-600",children:[(null==Q?void 0:Q.streak)||0,"/7"]})]})]})]})})]})]})]}),t.jsxs(n,{className:"mt-8 dark:bg-slate-800 dark:border-white/20 border-2 shadow-lg dark:shadow-[0_0_30px_rgba(255,255,255,0.4)]",children:[t.jsx(d,{children:t.jsx(c,{className:"dark:text-slate-100",children:"Actions rapides"})}),t.jsx(o,{children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-8 gap-4",children:[t.jsx(r,{to:"/my-courses",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2",children:[t.jsx(U,{className:"w-6 h-6"}),t.jsx("span",{children:"Mes cours"})]})}),t.jsx(r,{to:"/quiz",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2",children:[t.jsx(z,{className:"w-6 h-6"}),t.jsx("span",{children:"Quiz"})]})}),t.jsx(r,{to:"/study-plan",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2 border-primary/30 hover:border-primary hover:bg-primary/5",children:[t.jsx("span",{className:"text-2xl",children:"üìö"}),t.jsx("span",{className:"text-primary font-semibold",children:"Plan d'√âtude"})]})}),t.jsx(r,{to:"/challenges",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2 border-yellow-300 hover:border-yellow-500 hover:bg-yellow-50",children:[t.jsx(G,{className:"w-6 h-6 text-yellow-600"}),t.jsx("span",{className:"text-yellow-600 font-semibold text-sm",children:"D√©fis"})]})}),t.jsx(r,{to:"/social",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2 border-blue-300 hover:border-blue-500 hover:bg-blue-50",children:[t.jsx("span",{className:"text-2xl",children:"üë•"}),t.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"Social"})]})}),t.jsx(r,{to:"/analytics",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2 border-purple-300 hover:border-purple-500 hover:bg-purple-50",children:[t.jsx(te,{className:"w-6 h-6 text-purple-600"}),t.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"Analytics"})]})}),t.jsx(r,{to:"/leaderboard",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2",children:[t.jsx(se,{className:"w-6 h-6"}),t.jsx("span",{children:"Classement"})]})}),t.jsx(r,{to:"/profile",children:t.jsxs(x,{variant:"outline",className:"w-full h-20 flex-col gap-2",children:[t.jsx(ae,{className:"w-6 h-6"}),t.jsx("span",{children:"Profil"})]})})]})})]})]})]})]})};export{ns as default};
