import{r as e,j as s}from"./vendor-react-470eca1f.js";import{d as a,e as t,u as r,B as i,l as n}from"./index-80385b81.js";import{bd as o,be as l,bf as d,bg as c,aa as m,t as x,D as p,Y as u,ab as h}from"./vendor-ui-297a683c.js";const g=d,j=c,b=e.forwardRef(({className:e,align:t="center",sideOffset:r=4,...i},n)=>s.jsx(o,{children:s.jsx(l,{ref:n,align:t,sideOffset:r,className:a("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i})}));function v({url:a,title:o,description:l="",type:d="course",resourceId:c=null,options:v={},variant:w="outline",size:f="sm",showIcon:N=!0,buttonText:k="Partager"}){const{user:y}=t(),{toast:C}=r(),[z,I]=e.useState(null),[R,U]=e.useState(!1),[$,F]=e.useState(!1),[L,P]=e.useState(!1),S=async()=>{try{await navigator.clipboard.writeText(z),U(!0),C({title:"CopiÃ© ! âœ…",description:"Le lien a Ã©tÃ© copiÃ© dans le presse-papier"}),setTimeout(()=>U(!1),2e3)}catch(e){C({title:"Erreur",description:"Impossible de copier le lien",variant:"destructive"})}};return s.jsxs(g,{open:L,onOpenChange:P,children:[s.jsx(j,{asChild:!0,children:s.jsx(i,{variant:w,size:f,disabled:$,children:$?s.jsxs(s.Fragment,{children:[s.jsx(m,{className:"w-4 h-4 mr-2 animate-spin"}),"CrÃ©ation..."]}):s.jsxs(s.Fragment,{children:[N&&s.jsx(x,{className:"w-4 h-4 mr-2"}),k]})})}),s.jsx(b,{className:"w-96 dark:bg-slate-800 dark:border-white/20",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold text-sm mb-2 dark:text-white flex items-center gap-2",children:[s.jsx(x,{className:"w-4 h-4 text-primary"}),"Partager ce contenu"]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 line-clamp-2",children:o})]}),z?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border-2 border-blue-200 dark:border-blue-700",children:[s.jsx("code",{className:"text-sm text-blue-600 dark:text-blue-400 flex-1 truncate font-mono",children:z}),s.jsx(i,{size:"sm",variant:"ghost",onClick:S,className:"shrink-0",title:"Copier le lien",children:R?s.jsx(p,{className:"w-4 h-4 text-green-500"}):s.jsx(u,{className:"w-4 h-4"})}),s.jsx(i,{size:"sm",variant:"ghost",onClick:()=>{z&&window.open(z,"_blank","noopener,noreferrer")},className:"shrink-0",title:"Ouvrir le lien",children:s.jsx(h,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ğŸ’¡ Partagez ce lien sur :"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[navigator.share&&s.jsx(i,{variant:"outline",size:"sm",onClick:async()=>{if(navigator.share&&z)try{await navigator.share({title:o,text:l,url:z})}catch(e){e.name}},className:"text-xs",children:"ğŸ“± Partager"}),s.jsx(i,{variant:"outline",size:"sm",onClick:S,className:"text-xs",children:"ğŸ“‹ Copier"}),s.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.open(`https://wa.me/?text=${encodeURIComponent(o+" - "+z)}`,"_blank"),className:"text-xs",children:"ğŸ’¬ WhatsApp"}),s.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(z)}`,"_blank"),className:"text-xs",children:"ğŸ“˜ Facebook"}),s.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(z)}&text=${encodeURIComponent(o)}`,"_blank"),className:"text-xs",children:"ğŸ¦ Twitter"}),s.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.open(`mailto:?subject=${encodeURIComponent(o)}&body=${encodeURIComponent(z)}`,"_blank"),className:"text-xs",children:"ğŸ“§ Email"})]})]}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 pt-2 border-t dark:border-gray-700",children:["ğŸ“Š Vous pouvez suivre les statistiques de ce lien dans"," ",s.jsx("span",{className:"text-primary font-medium",children:"Mes Liens de Partage"})]})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"CrÃ©ez un lien court facile Ã  partager avec vos camarades"}),s.jsx(i,{onClick:async()=>{if(y){F(!0);try{const e=await n.createCourseLink(a,{userId:y.id,resourceId:c,linkType:d,title:o,description:l,tags:v.tags||[d],slug:v.slug});I(e.shortLink),C({title:"Lien crÃ©Ã© ! ğŸ”—",description:"Votre lien de partage est prÃªt"})}catch(e){C({title:"Erreur",description:e.message||"Impossible de crÃ©er le lien de partage",variant:"destructive"})}finally{F(!1)}}else C({title:"Connexion requise",description:"Vous devez Ãªtre connectÃ© pour partager du contenu",variant:"destructive"})},disabled:$,className:"w-full",size:"default",children:$?s.jsxs(s.Fragment,{children:[s.jsx(m,{className:"w-4 h-4 mr-2 animate-spin"}),"CrÃ©ation en cours..."]}):s.jsxs(s.Fragment,{children:[s.jsx(x,{className:"w-4 h-4 mr-2"}),"CrÃ©er un lien court"]})})]})]})})]})}b.displayName=l.displayName;export{v as S};
